<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Leaf - Dashboard</title>

    <link rel="icon" href="">
    <link rel="stylesheet" href="css/dashboardPage.css">

    <!-- SCRIPT PARA PUXAR A BIBLIOTECA DO CHARTJS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.8/css/line.css">
</head>

<body>
    <!-- PAG MENU -->
    <div class="container">

        <div class="lateral">
            <!-- parte de cima -->
            <div class="listaBaixo">
                <div class="navegacão">
                    <div class="navHeader">
                        <img src="../../assets/icon/logo.svg">
                        <span>MENU</span>
                    </div>
                    <ul>
                        <li class="lista destaque">
                            <a href="dashboardPage.html">
                                <i class="uil uil-create-dashboard"></i>
                                <span class="lista">Dashboard</span>
                            </a>
                        </li>
                        <li class="lista">
                            <a href="estatisticaPage.html">
                                <i class="uil uil-presentation-line"></i>
                                <span class="lista">Estatística</span>
                            </a>
                        </li>
                        <!-- <li class="lista">
                            <a href="previsaoPage.html">
                                <i class="uil uil-chart-pie"></i>
                                <span class="lista">Previsões</span>
                            </a>
                        </li> -->
                        <li class="lista">
                            <a href="historicoPage.html">
                                <i class="uil uil-history"></i>
                                <span class="lista">Histórico</span>
                            </a>
                        </li>
                    </ul>
                    <div class="inferior-menu" style="background-image: url(../../assets/imgs/VectorPéMenu.svg);">
                        <ul style="height: fit-content;">
                            <li class="lista">
                                <a href="cadastrarUsuario.html">
                                    <i class="uil uil-plus-circle"></i>
                                    <span class="lista" style="font-size: 15px;">Cadastrar usuario</span>
                                </a>
                            </li>
                            <li class="lista">
                                <a href="cadastrarEstufa.html">
                                    <i class="uil uil-plus-circle"></i>
                                    <span class="lista" style="font-size: 15px;">Cadastrar estufa</span>
                                </a>
                            </li>
                        </ul>
                    </div>

                </div>

                <!-- parte de baixo -->
                <!-- <div class="trindade">
                    <div class="configNomeimg">
                        <div class="nomeNome">
                            <img src="imgs/Ellipse2325.png">
                            <ul class="ul2">
                                <span class="ismalendas">
                                    <span>NomeUsuario</span>
                                    <span>NomeEmpresa</span>
                                </span>
                            </ul>
                        </div> -->

                <!-- <div class="configgg">
                            <a href="#">
                                <i class="uil uil-setting"></i>
                            </a>
                            <a href="../home/login.html">
                                <i class="uil uil-signout" style="color: #C63535;"></i>
                            </a>
                        </div>
                    </div>
                </div> -->
            </div>
        </div>
        <!-- FIM DO MENU -->

        <!-- parte do dash -->
        <div class="tela">
            <div class="top">
                <div class="top-left">
                    <span class="topo">Dashboard</span>
                </div>
                <div class="nomeNome">
                    <img src="../../assets/imgs/Ellipse2325.png">
                    <ul class="ul2">
                        <span class="ismalendas">
                            <span id="b_usuario">NomeUsuario</span>
                           
                            <span>NomeEmpresa</span>
                        </span>
                    </ul>
                </div>
            </div>

        <!-- ALTERAÇÕES FEITA ATÉ ESSA PARTE  -->

            <div class="areaDash">
                <div>
                    <div class="alertsParametro">
                        <div class="urgente">
                            <img src="../../assets/imgs/vetorUrgente.svg">
                            <span class="urgenteText">URGENTE</span>
                        </div>
                        <div class="critico">
                            <img src="../../assets/imgs/vectorCritico.svg">
                            <span class="criticoText">CRÍTICO</span>
                        </div>
                        <div class="preocupante">
                            <img src="../../assets/imgs/vectorPreocupante.svg">
                            <span class="preocupanteText">PREOCUPANTE</span>
                        </div>
                        <div class="adequado">
                            <img src="../../assets/imgs/vetorAdequado.svg">
                            <span class="adequadoText">ADEQUADO</span>
                        </div>
                    </div>
                </div>
            </div>





            <div class="daddy">
                <div class="main">


                    <div class="containerChart">
                        <div class="tittle_chart">
                            <span>
                                MEDIA DA LUMINOSIDADE DAS ESTUFAS NAS ULTIMAS 24H
                            </span>
                        </div>
                        <canvas id="myChart1"></canvas>
                    </div>
                    <!-- <div class="containerChart">
                        <div class="chartContainer">
                            <div class="grafico1">
                                <span class="title-Chart"></span>
                                <span class="subTittle-Chart">EM CADA ESTUFA</span>
                            </div>
                        </div>
                    </div> -->

                    <div class="rodape">
                        <div class="ajuste_pie">
                            <p>SITUAÇÃO DOS SETORES</p>
                            <div class="grafico_pie">
                                <div class="teste">
                                    <canvas id="grafico_pizza"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="indice_luz_pai">
                            <div class="daddy_indice">
                                <div class="alto_indice_luz">
                                    <div class="maior_indice_luz">
                                        MAIOR ÍNDICE DE LUZ CAPTADO <br>
                                        <p>820lm</p>
                                    </div>
                                    <div class="indicacao_estufa">
                                        Guimarães - setor 1
                                    </div>
                                    <span class="hora"><img src="../../assets/imgs/relogio.svg">09:35
                                    </span>

                                </div>
                                <div class="baixo_indice_luz">
                                    <div class="menor_indice_luz">
                                        MENOR ÍNDICE DE LUZ CAPTADO<br>
                                        <p>200lm</p>
                                        <div class="indicacao_estufa">
                                            Paulista - setor 02
                                        </div>
                                        <span style="color: #6D2D2D;" class="hora"><img
                                                src="../../assets/imgs/relogio.svg">08:20
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="alerta_estufas">
                                <div class="ajuste">
                                    <div class="indicativo_alerta_estufas">
                                        Estufas com mais alertas
                                    </div>
                                    <div class="mencao_estufas">
                                        <div class="mencionar_estufa1">
                                            Antônio
                                        </div>
                                        <div class="mencionar_estufa2">
                                            Guimarães
                                        </div>
                                        <div class="mencionar_estufa3">
                                            Paulista
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ALERTA URGENTE -->
                <div class="lado_direito">
                    <div class="tela-alertas">
                        <span class="title-alerta">ALERTAS</span>

                        <div class="listaScroller">
                            <a class="click-alert" href="setor1.html">
                                <div class="containerAlert">
                                    <div class="alert">
                                        <div class="img">
                                            <img class="img-alert" src="../../assets/imgs/alert-icon.svg" alt="">
                                        </div>
                                        <div
                                            style="display: flex; flex-direction: column; justify-content: center; gap: 10px; width: 205px;">
                                            <div class="urgenteEst">
                                                <span class="urgente">ESTUFA GUIMARÃES</span>
                                                <span class="urgente">SETOR 1</span>
                                            </div>

                                            <div class="alerts">
                                                <div class="text-valores">
                                                    <span class="text-atual">ÍNDICE ATUAL: 300lm</span>
                                                </div>
                                                <div
                                                    style="display: flex; justify-content: space-between; width: 100%;">
                                                    <span class="text-parametro-urgente">IDEAL: 500 - 600</span>
                                                    <span class="hora"><img src="../../assets/imgs/relogio.svg">09:35
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>

                            <a class="click-alert" href="setor2.html">
                                <div class="containerAlert">
                                    <div class="alert">
                                        <div class="img">
                                            <img class="img-alert" src="../../assets/imgs/alert-icon.svg" alt="">
                                        </div>
                                        <div
                                            style="display: flex; flex-direction: column; justify-content: center; gap: 10px; width: 205px;">
                                            <div class="urgenteEst">
                                                <span class="urgente">ESTUFA GUIMARÃES</span>
                                                <span class="urgente">SETOR 2</span>
                                            </div>

                                            <div class="alerts">
                                                <div class="text-valores">
                                                    <span class="text-atual">ÍNDICE ATUAL: 0lm</span>
                                                </div>
                                                <div
                                                    style="display: flex; justify-content: space-between; width: 100%;">
                                                    <span class="text-parametro-urgente">IDEAL: 500 - 600</span>
                                                    <span class="hora"><img src="../../assets/imgs/relogio.svg">09:35
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>

                            <a class="click-alert" href="setor1.html">
                                <div class="containerAlert">
                                    <div class="alert">
                                        <div class="img">
                                            <img class="img-alert" src="../../assets/imgs/alert-icon.svg" alt="">
                                        </div>
                                        <div
                                            style="display: flex; flex-direction: column; justify-content: center; gap: 10px; width: 205px;">
                                            <div class="urgenteEst">
                                                <span class="urgente">ESTUFA GUIMARÃES</span>
                                                <span class="urgente">SETOR 3</span>
                                            </div>

                                            <div class="alerts">
                                                <div class="text-valores">
                                                    <span class="text-atual">ÍNDICE ATUAL: 0lm</span>
                                                </div>
                                                <div
                                                    style="display: flex; justify-content: space-between; width: 100%;">
                                                    <span class="text-parametro-urgente">IDEAL: 500 - 600</span>
                                                    <span class="hora"><img src="../../assets/imgs/relogio.svg">09:35
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <a class="click-alert" href="setor2.html">
                                <div class="containerAlert">
                                    <div class="alert">
                                        <div class="img">
                                            <img class="img-alert-critico" src="../../assets/imgs/vetorUrgente.svg"
                                                width="30px">
                                        </div>
                                        <div
                                            style="display: flex; flex-direction: column; justify-content: center; gap: 10px; width: 205px;">
                                            <div class="urgenteEst">
                                                <span class="urgente">ESTUFA ANTÔNIO</span>
                                                <span class="urgente">SETOR 2</span>
                                            </div>

                                            <div class="alerts">
                                                <div class="text-valores">
                                                    <span class="text-atual">ÍNDICE ATUAL: 245lm</span>
                                                </div>
                                                <div
                                                    style="display: flex; justify-content: space-between; width: 100%;">
                                                    <span class="text-parametro-urgente">IDEAL: 500 - 600</span>
                                                    <span class="hora"><img src="../../assets/imgs/relogio.svg">09:35
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>

                            <a class="click-alert" href="setor2.html">
                                <div class="containerAlert">
                                    <div class="alertCritico">
                                        <div class="img">
                                            <img class="img-alert-critico" src="../../assets/imgs/vectorCritico.svg"
                                                width="30px">
                                        </div>
                                        <div
                                            style="display: flex; flex-direction: column; justify-content: center; gap: 10px; width: 205px;">
                                            <div class="urgenteEst">
                                                <span class="critico">ESTUFA ANTÔNIO</span>
                                                <span class="critico">SETOR 3</span>
                                            </div>

                                            <div class="alerts">
                                                <div class="text-valores">
                                                    <span class="text-atual-critico">ÍNDICE ATUAL: 245lm</span>
                                                </div>
                                                <div
                                                    style="display: flex; justify-content: space-between; width: 100%;">
                                                    <span class="text-parametro-urgente">IDEAL: 500 - 600</span>
                                                    <span class="hora"><img src="../../assets/imgs/relogio.svg">09:35
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>

                            <a class="click-alert" href="setor2.html">
                                <div class="containerAlert">
                                    <div class="alertPreocupante">
                                        <div class="img">
                                            <img class="img-alert-critico" src="../../assets/imgs/vectorPreocupante.svg"
                                                width="30px">
                                        </div>
                                        <div
                                            style="display: flex; flex-direction: column; justify-content: center; gap: 10px; width: 205px;">
                                            <div class="urgenteEst">
                                                <span class="preocupante">ESTUFA ANTÔNIO</span>
                                                <span class="preocupante">SETOR 4</span>
                                            </div>

                                            <div class="alerts">
                                                <div class="text-valores">
                                                    <span class="text-atual-preocupante">ÍNDICE ATUAL:
                                                        470lm</span>
                                                </div>
                                                <div
                                                    style="display: flex; justify-content: space-between; width: 100%;">
                                                    <span class="text-parametro-urgente">IDEAL: 500 - 600</span>
                                                    <span class="hora"><img src="../../assets/imgs/relogio.svg">09:35
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <a class="click-alert" href="setor2.html">
                                <div class="containerAlert">
                                    <div class="alertPreocupante">
                                        <div class="img">
                                            <img class="img-alert-critico" src="../../assets/imgs/vectorPreocupante.svg"
                                                width="30px">
                                        </div>
                                        <div
                                            style="display: flex; flex-direction: column; justify-content: center; gap: 10px; width: 205px;">
                                            <div class="urgenteEst">
                                                <span class="preocupante">ESTUFA ANTÔNIO</span>
                                                <span class="preocupante">SETOR 1</span>
                                            </div>

                                            <div class="alerts">
                                                <div class="text-valores">
                                                    <span class="text-atual-preocupante">ÍNDICE ATUAL:
                                                        460lm</span>
                                                </div>
                                                <div
                                                    style="display: flex; justify-content: space-between; width: 100%;">
                                                    <span class="text-parametro-urgente">IDEAL: 500 - 600</span>
                                                    <span class="hora"><img src="../../assets/imgs/relogio.svg">09:35
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>

                        </div>

                        <!--ALERTA CRÍTICO -->


                        <!-- ALERTA CRÍTICO  -->

                        <!-- <a class="click-alert-critico" href="">
                            <div class="containerAlert">
                                <div class="alert-critico">
                                    <div class="img">
                                        <img class="img-alert" src="../../assets/imgs/vectorCritico.svg">
                                    </div>
                                    <div class="urgenteEst-critico">
                                        <span class="critico">ESTUFA 05 - SETOR X</span>
                                    </div>

                                    <div class="alerts">
                                        <div class="text-valores">
                                            <div>
                                                <span class="critico-valor">ÍNDICE ATUAL: 700</span>
                                            </div>
                                            <div>
                                                <span class="text-parametro-critico">IDEAL: 500 - 805</span>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </a> -->

                        <!-- ALERTA PREOCUPANTE -->
                        <!-- <a class="click-alert-preocupante" href="">
                            <div class="containerAlert">
                                <div class="alert-preocupante">
                                    <div class="urgenteEst-preocupado">
                                        <img class="img-alert" src="../../assets/imgs/vectorPreocupante.svg" alt="">
                                        <span class="preocupante">ESTUFA 05 - SETOR X</span>
                                    </div>
                                    <div class="alerts-preocupante">
                                        <div class="text-valores">
                                            <div>
                                                <span class="preocupante-valor">ÍNDICE ATUAL: 470</span>
                                            </div>
                                            <div>
                                                <span class="text-parametro-preocupante">IDEAL: 500 - 805
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </a> -->



                    </div>
                    <!-- <div class="alertas_rodape">
                        <div class="indicador_alertas">
                            <div class="alerta_urgente">
                                <div class="img_alert_all">
                                    <img src="alert-icon.svg">
                                </div>
                                <span> Urgente </span>
                            </div>
                            <div class="alerta_critico">
                                <div class="img_alert_all">
                                    <img src="../../assets/imgs/vectorCritico.svg">
                                </div>
                                <span> Crítico </span>
                            </div>
                            <div class="alerta_preocupante">
                                <div class="img_alert_all">
                                    <img src="../../assets/imgs/vectorPreocupante.svg">
                                </div>
                                <span>Preocupante</span>
                            </div>
                        </div>
                    </div> -->
                </div>

            </div>
        </div>



        <!-- <div>
            <canvas id="myChart2" style="position: relative; height:40vh; width:40vw"></canvas></canvas>
        </div> -->

</body>
<script>
    const labels = [
        '12:00',
        '13:00',
        '14:00',
        '15:00',
        '16:00',
        '17:00',
    ];

    const data = {
        labels: labels,
        datasets: [{
            label: 'Antônio',
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            data: [687, 700, 760, 850, 840, 930],
        },
        {
            label: 'Paulista',
            backgroundColor: 'rgb(148, 0, 211)',
            borderColor: 'rgb(148, 0, 211)',
            data: [520, 500, 700, 560, 610, 560],
        },
        {
            label: 'Guimarães',
            backgroundColor: 'rgb(18, 10, 143)',
            borderColor: 'rgb(18, 10, 143)',
            data: [200, 266, 200, 233, 166, 200],
        }
        ]
    };

    const config = {
        type: 'line',
        data: data,
        options: {}
    };
</script>

<script>
    const myChart1 = new Chart(
        document.getElementById('myChart1'),
        config
    );
    // const myChart2 = new Chart(
    //     document.getElementById('myChart2'),
    //     config
    // );
</script>

<script>
    const grafico_pie = document.getElementById('grafico_pizza');

    new Chart(grafico_pie, {
        type: 'doughnut',
        data: {
            labels: ['Setores urgentes', 'Setores críticos', 'Setores preocupantes', 'Setores adequados'],
            datasets: [{
                data: [4, 6, 2, 17],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
</script>

<script>
    b_usuario.innerHTML = sessionStorage.EMAIL_USUARIO;

    let proximaAtualizacao;

    window.onload = obterDadosGraficos();

    function obterDadosGraficos() {
        obterDadosGrafico(1)
        obterDadosGrafico(2)
        obterDadosGrafico(3)
        obterDadosGrafico(4)
    }


    function obterDadosGrafico(idAquario) {


    if (proximaAtualizacao != undefined) {
        clearTimeout(proximaAtualizacao);
    }

fetch(`/medidas/ultimas/${idAquario}`, { cache: 'no-store' }).then(function (response) {
    if (response.ok) {
        response.json().then(function (resposta) {
            console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
            resposta.reverse();

            plotarGrafico(resposta, idAquario);
        });
    } else {
        console.error('Nenhum dado encontrado ou erro na API');
    }
})
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });
}
</script>

</html>